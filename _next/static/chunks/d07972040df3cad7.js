(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,35914,e=>{"use strict";var a=e.i(43476),s=e.i(71645),t=e.i(4049),n=e.i(83942),l=e.i(57951),i=e.i(19455),r=e.i(55593),c=e.i(10204),o=e.i(24687),d=e.i(76639),m=e.i(67489),h=e.i(7233),x=e.i(31278),p=e.i(46696);function u({open:e,onOpenChange:u}){let[j,g]=(0,s.useState)(!1),v=void 0!==e,N=v?u:g,[y,f]=(0,s.useState)({contact_name:"",company_name:"",email:"",phone:"",address:"",postal_code:"",region_id:"",status:"prospect",notes:""}),k=(0,t.useCreateClient)(),{data:_=[]}=(0,n.useRegions)(),{user:w}=(0,l.useAuth)();w?.role==="admin"||w?.role;let C=async e=>{if(e.preventDefault(),!y.contact_name)return void p.toast.error("Meno kontaktnej osoby je povinné");try{await k.mutateAsync({contact_name:y.contact_name,company_name:y.company_name||null,email:y.email||null,phone:y.phone||null,address:y.address||null,postal_code:y.postal_code||null,region_id:y.region_id||null,status:y.status,notes:y.notes||null}),p.toast.success("Klient bol úspešne vytvorený"),N?.(!1),f({contact_name:"",company_name:"",email:"",phone:"",address:"",postal_code:"",region_id:"",status:"prospect",notes:""})}catch(e){console.error("Create client error:",e),p.toast.error(e.message||"Nepodarilo sa vytvoriť klienta"),e.details&&p.toast.error(e.details)}};return(0,a.jsxs)(d.Dialog,{open:v?e:j,onOpenChange:N,children:[(0,a.jsx)(d.DialogTrigger,{asChild:!0,children:(0,a.jsx)(i.Button,{className:"md:hidden min-h-[44px] min-w-[44px]",size:"icon",title:"Nový klient",children:(0,a.jsx)(h.Plus,{className:"h-4 w-4"})})}),(0,a.jsx)(d.DialogTrigger,{asChild:!0,children:(0,a.jsxs)(i.Button,{className:"hidden md:flex",children:[(0,a.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Nový klient"]})}),(0,a.jsxs)(d.DialogContent,{className:"max-w-[95vw] sm:max-w-[500px]",children:[(0,a.jsx)(d.DialogHeader,{children:(0,a.jsx)(d.DialogTitle,{children:"Vytvoriť nového klienta"})}),(0,a.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"contact_name",children:"Meno a priezvisko *"}),(0,a.jsx)(r.Input,{id:"contact_name",placeholder:"Ján Novák",value:y.contact_name,onChange:e=>f({...y,contact_name:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"company_name",children:"Firma"}),(0,a.jsx)(r.Input,{id:"company_name",placeholder:"Firma s.r.o.",value:y.company_name,onChange:e=>f({...y,company_name:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"email",children:"Email"}),(0,a.jsx)(r.Input,{id:"email",type:"email",placeholder:"jan@example.com",value:y.email,onChange:e=>f({...y,email:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"phone",children:"Telefón"}),(0,a.jsx)(r.Input,{id:"phone",placeholder:"+421 9xx xxx xxx",value:y.phone,onChange:e=>f({...y,phone:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"address",children:"Adresa"}),(0,a.jsx)(r.Input,{id:"address",placeholder:"Ulica 123",value:y.address,onChange:e=>f({...y,address:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"postal_code",children:"PSČ"}),(0,a.jsx)(r.Input,{id:"postal_code",placeholder:"000 00",value:y.postal_code,onChange:e=>f({...y,postal_code:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"region",children:"Región"}),(0,a.jsxs)(m.Select,{value:y.region_id||"none",onValueChange:e=>f({...y,region_id:"none"===e?"":e}),children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{placeholder:"Vyberte región"})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"none",children:"Bez regiónu"}),_.map(e=>(0,a.jsx)(m.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"notes",children:"Poznámka"}),(0,a.jsx)(o.Textarea,{id:"notes",placeholder:"Interné poznámky...",value:y.notes,onChange:e=>f({...y,notes:e.target.value})})]}),(0,a.jsxs)(d.DialogFooter,{children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>N?.(!1),disabled:k.isPending,children:"Zrušiť"}),(0,a.jsx)(i.Button,{type:"submit",disabled:k.isPending,children:k.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Vytváram..."]}):"Vytvoriť klienta"})]})]})]})]})}let j={active:"Aktívny",inactive:"Neaktívny",prospect:"Potenciálny",completed:"Ukončená spolupráca"};function g({client:e,open:l,onOpenChange:h}){let[u,g]=(0,s.useState)({contact_name:"",company_name:"",email:"",phone:"",address:"",postal_code:"",region_id:"",notes:"",status:"prospect",total_value:""}),v=(0,t.useUpdateClient)(),{data:N=[]}=(0,n.useRegions)();(0,s.useEffect)(()=>{e&&g({contact_name:e.contact_name||"",company_name:e.company_name||"",email:e.email||"",phone:e.phone||"",address:e.address||"",postal_code:e.postal_code||"",region_id:e.region_id||"",notes:e.notes||"",status:e.status||"prospect",total_value:e.total_value?.toString()||""})},[e,l]);let y=async a=>{if(a.preventDefault(),e){if(!u.contact_name)return void p.toast.error("Meno kontaktnej osoby je povinné");try{await v.mutateAsync({id:e.id,contact_name:u.contact_name,company_name:u.company_name||null,email:u.email||null,phone:u.phone||null,address:u.address||null,postal_code:u.postal_code||null,region_id:u.region_id||null,notes:u.notes||null,status:u.status,total_value:u.total_value?parseFloat(u.total_value):0}),p.toast.success("Klient bol úspešne aktualizovaný"),h(!1)}catch(e){p.toast.error("Nepodarilo sa aktualizovať klienta"),console.error(e)}}};return(0,a.jsx)(d.Dialog,{open:l,onOpenChange:h,children:(0,a.jsxs)(d.DialogContent,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(d.DialogHeader,{children:(0,a.jsx)(d.DialogTitle,{children:"Upraviť klienta"})}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-status",children:"Status"}),(0,a.jsxs)(m.Select,{value:u.status,onValueChange:e=>g({...u,status:e}),children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{placeholder:"Status"})}),(0,a.jsx)(m.SelectContent,{children:Object.entries(j).map(([e,s])=>(0,a.jsx)(m.SelectItem,{value:e,children:s},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-total_value",children:"Celková hodnota (€)"}),(0,a.jsx)(r.Input,{id:"edit-total_value",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:u.total_value,onChange:e=>g({...u,total_value:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-contact_name",children:"Meno a priezvisko *"}),(0,a.jsx)(r.Input,{id:"edit-contact_name",placeholder:"Ján Novák",value:u.contact_name,onChange:e=>g({...u,contact_name:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-company_name",children:"Firma"}),(0,a.jsx)(r.Input,{id:"edit-company_name",placeholder:"Firma s.r.o.",value:u.company_name,onChange:e=>g({...u,company_name:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-email",children:"Email"}),(0,a.jsx)(r.Input,{id:"edit-email",type:"email",placeholder:"jan@example.com",value:u.email,onChange:e=>g({...u,email:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-phone",children:"Telefón"}),(0,a.jsx)(r.Input,{id:"edit-phone",placeholder:"+421 9xx xxx xxx",value:u.phone,onChange:e=>g({...u,phone:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-address",children:"Adresa"}),(0,a.jsx)(r.Input,{id:"edit-address",placeholder:"Ulica 123",value:u.address,onChange:e=>g({...u,address:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-postal_code",children:"PSČ"}),(0,a.jsx)(r.Input,{id:"edit-postal_code",placeholder:"000 00",value:u.postal_code,onChange:e=>g({...u,postal_code:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-region",children:"Región"}),(0,a.jsxs)(m.Select,{value:u.region_id,onValueChange:e=>g({...u,region_id:e}),children:[(0,a.jsx)(m.SelectTrigger,{children:(0,a.jsx)(m.SelectValue,{placeholder:"Vyberte región"})}),(0,a.jsx)(m.SelectContent,{children:N.map(e=>(0,a.jsx)(m.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"edit-notes",children:"Poznámka"}),(0,a.jsx)(o.Textarea,{id:"edit-notes",placeholder:"Interné poznámky...",value:u.notes,onChange:e=>g({...u,notes:e.target.value})})]}),(0,a.jsxs)(d.DialogFooter,{children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>h(!1),disabled:v.isPending,children:"Zrušiť"}),(0,a.jsx)(i.Button,{type:"submit",disabled:v.isPending,children:v.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Ukladám..."]}):"Uložiť zmeny"})]})]})]})})}var v=e.i(87486),N=e.i(2747),y=e.i(48065),f=e.i(63488),k=e.i(43432),_=e.i(46897),w=e.i(87316),C=e.i(84614),b=e.i(51975),S=e.i(75254);let P=(0,S.default)("euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);var z=e.i(27516),D=e.i(78583),F=e.i(99353),I=e.i(95468);let M={call:(0,a.jsx)(k.Phone,{className:"h-4 w-4"}),email:(0,a.jsx)(f.Mail,{className:"h-4 w-4"}),meeting:(0,a.jsx)(w.Calendar,{className:"h-4 w-4"}),note:(0,a.jsx)(F.StickyNote,{className:"h-4 w-4"}),status_change:(0,a.jsx)(I.CheckCircle2,{className:"h-4 w-4"})};function T({client:e,open:s,onOpenChange:t,statusLabels:n,statusVariants:l,getRegionName:r,formatCurrency:c,onEdit:o}){let{data:m=[],isLoading:h}=(0,y.useActivities)({entityType:"client",entityId:e?.id,limit:5});return e?(0,a.jsx)(d.Dialog,{open:s,onOpenChange:t,children:(0,a.jsxs)(d.DialogContent,{className:"max-w-[95vw] sm:max-w-[600px] max-h-[85vh] overflow-y-auto",children:[(0,a.jsxs)(d.DialogHeader,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mr-8",children:[(0,a.jsx)(d.DialogTitle,{className:"text-xl",children:e.contact_name}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.Badge,{variant:l[e.status],children:n[e.status]}),o&&(0,a.jsx)(i.Button,{variant:"outline",size:"sm",onClick:o,children:"Upraviť"})]})]}),e.company_name&&(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:e.company_name})]}),(0,a.jsxs)("div",{className:"space-y-6 py-4",children:[(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Kontaktné údaje"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.email&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(f.Mail,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("a",{href:`mailto:${e.email}`,className:"hover:underline",children:e.email})]}),e.phone&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(k.Phone,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("a",{href:`tel:${e.phone}`,className:"hover:underline",children:e.phone})]}),(e.address||e.postal_code)&&(0,a.jsxs)("div",{className:"flex items-start gap-2 text-sm sm:col-span-2",children:[(0,a.jsx)(_.MapPin,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),(0,a.jsx)("span",{children:[e.address,e.postal_code].filter(Boolean).join(", ")})]})]})]}),(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Informácie"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(b.Tag,{className:"h-3 w-3"})," Región"]}),(0,a.jsx)("p",{className:"text-sm font-medium",children:r(e.region_id)})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(C.User,{className:"h-3 w-3"})," Priradené"]}),(0,a.jsx)("p",{className:"text-sm font-medium",children:e.assigned_user?.full_name||"Nepriradené"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(P,{className:"h-3 w-3"})," Celková hodnota"]}),(0,a.jsx)("p",{className:"text-sm font-medium",children:c(e.total_value)})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(w.Calendar,{className:"h-3 w-3"})," Vytvorené"]}),(0,a.jsx)("p",{className:"text-sm font-medium",children:new Date(e.created_at).toLocaleDateString("sk-SK")})]})]})]}),e.notes&&(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Poznámka"}),(0,a.jsx)("div",{className:"bg-muted/50 p-4 rounded-lg text-sm whitespace-pre-wrap",children:e.notes})]}),(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(z.History,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Posledné aktivity"})]}),h?(0,a.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,a.jsx)(N.Skeleton,{className:"h-16 w-full"},e))}):0===m.length?(0,a.jsx)("div",{className:"text-center py-8 text-sm text-muted-foreground bg-muted/30 rounded-lg",children:"Žiadne aktivity"}):(0,a.jsx)("div",{className:"space-y-3",children:m.map(e=>(0,a.jsxs)("div",{className:"flex gap-3 p-3 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors",children:[(0,a.jsx)("div",{className:"text-primary mt-0.5",children:M[e.activity_type]||(0,a.jsx)(D.FileText,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-foreground",children:e.title}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:new Date(e.created_at).toLocaleDateString("sk-SK")})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:e.description})]})]},e.id))})]})]})]})}):null}let L={call:"Telefonát",email:"Email",meeting:"Stretnutie",note:"Poznámka",status_change:"Zmena statusu"},B={call:(0,a.jsx)(k.Phone,{className:"h-4 w-4"}),email:(0,a.jsx)(f.Mail,{className:"h-4 w-4"}),meeting:(0,a.jsx)(w.Calendar,{className:"h-4 w-4"}),note:(0,a.jsx)(F.StickyNote,{className:"h-4 w-4"}),status_change:(0,a.jsx)(F.StickyNote,{className:"h-4 w-4"})};function V({open:e,onOpenChange:t,entityType:n,entityId:l,entityName:h,defaultType:u="note",defaultContact:j}){let[g,v]=(0,s.useState)(u),[N,_]=(0,s.useState)(""),[C,b]=(0,s.useState)(""),S=(0,y.useCreateActivity)(),P=e=>{e||(_(""),b(""),v(u)),t(e)},z=e=>{switch(e){case"call":return j?.phone?`Telefon\xe1t na ${j.phone}`:"Telefonát";case"email":return j?.email?`Email pre ${j.email}`:"Email";case"meeting":return"Stretnutie";case"note":return"Poznámka";default:return""}},D=async e=>{if(e.preventDefault(),!N.trim())return void p.toast.error("Zadajte nadpis aktivity");try{await S.mutateAsync({entity_type:n,entity_id:l,activity_type:g,title:N.trim(),description:C.trim()||void 0}),p.toast.success("Aktivita bola pridaná",{description:`${L[g]} pre ${h||"kontakt"}`}),P(!1)}catch(e){p.toast.error("Chyba pri pridávaní aktivity",{description:e.message})}};return(0,a.jsx)(d.Dialog,{open:e,onOpenChange:P,children:(0,a.jsx)(d.DialogContent,{className:"sm:max-w-[500px]",children:(0,a.jsxs)("form",{onSubmit:D,children:[(0,a.jsxs)(d.DialogHeader,{children:[(0,a.jsx)(d.DialogTitle,{children:"Pridať aktivitu"}),(0,a.jsxs)(d.DialogDescription,{children:["Rýchle zaznamenanie aktivity pre ","lead"===n?"lead":"klienta"," ",h]})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"activity-type",children:"Typ aktivity"}),(0,a.jsxs)(m.Select,{value:g,onValueChange:e=>{v(e),N||_(z(e))},children:[(0,a.jsx)(m.SelectTrigger,{id:"activity-type",children:(0,a.jsx)(m.SelectValue,{})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"call",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(k.Phone,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Telefonát"})]})}),(0,a.jsx)(m.SelectItem,{value:"email",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.Mail,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Email"})]})}),(0,a.jsx)(m.SelectItem,{value:"meeting",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.Calendar,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Stretnutie"})]})}),(0,a.jsx)(m.SelectItem,{value:"note",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(F.StickyNote,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Poznámka"})]})})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"title",children:"Nadpis *"}),(0,a.jsx)(r.Input,{id:"title",value:N,onChange:e=>_(e.target.value),placeholder:z(g),required:!0,autoFocus:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.Label,{htmlFor:"description",children:"Popis (voliteľné)"}),(0,a.jsx)(o.Textarea,{id:"description",value:C,onChange:e=>b(e.target.value),placeholder:"Pridajte poznámky alebo detaily...",rows:4,className:"resize-none"})]}),(j?.email||j?.phone)&&(0,a.jsxs)("div",{className:"rounded-lg bg-muted/50 p-3 text-sm space-y-1",children:[(0,a.jsx)("p",{className:"font-medium text-muted-foreground",children:"Kontaktné údaje:"}),j.phone&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-foreground",children:[(0,a.jsx)(k.Phone,{className:"h-3 w-3"}),(0,a.jsx)("a",{href:`tel:${j.phone}`,className:"hover:underline",children:j.phone})]}),j.email&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-foreground",children:[(0,a.jsx)(f.Mail,{className:"h-3 w-3"}),(0,a.jsx)("a",{href:`mailto:${j.email}`,className:"hover:underline",children:j.email})]})]})]}),(0,a.jsxs)(d.DialogFooter,{children:[(0,a.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>P(!1),disabled:S.isPending,children:"Zrušiť"}),(0,a.jsx)(i.Button,{type:"submit",disabled:S.isPending,children:S.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Ukladám..."]}):(0,a.jsxs)(a.Fragment,{children:[B[g],(0,a.jsx)("span",{className:"ml-2",children:"Pridať"})]})})]})]})})})}var A=e.i(81914),U=e.i(40803),O=e.i(15288),E=e.i(99676),R=e.i(2335),K=e.i(55436),$=e.i(61911);let H=(0,S.default)("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),Z=(0,S.default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);var q=e.i(7486),J=e.i(41071),Q=e.i(55146),G=e.i(75157);let W={active:"Aktívny",inactive:"Neaktívny",prospect:"Potenciálny",completed:"Vybavený"},X={active:"success",inactive:"secondary",prospect:"info",completed:"completed"};function Y(){let[e,l]=(0,s.useState)(""),c=(0,R.useDebounce)(e,500),[o,d]=(0,s.useState)("all"),[x,j]=(0,s.useState)("grid"),[y,w]=(0,s.useState)(null),[C,b]=(0,s.useState)(null),[S,P]=(0,s.useState)(!1),[z,D]=(0,s.useState)(!1),[I,M]=(0,s.useState)(!1),[L,B]=(0,s.useState)(!1),[Y,ee]=(0,s.useState)(""),[ea,es]=(0,s.useState)(!1),[et,en]=(0,s.useState)("note"),{data:el=[],isLoading:ei,isError:er}=(0,t.useClients)({search:c,status:"all"===o?void 0:o}),{data:ec=[]}=(0,n.useRegions)(),eo=(0,t.useDeleteClient)(),ed=(0,s.useMemo)(()=>el||[],[el]),em=e=>{if(!e)return"Neurčený";let a=ec.find(a=>a.id===e);return a?.name||"Neurčený"},eh=e=>new Intl.NumberFormat("sk-SK",{style:"currency",currency:"EUR"}).format(e||0),ex=async e=>{if(confirm("Naozaj chcete vymazať tohto klienta?"))try{await eo.mutateAsync(e),p.toast.success("Klient bol vymazaný")}catch{p.toast.error("Nepodarilo sa vymazať klienta")}},ep=(e,a,s)=>{s.stopPropagation(),b(e),en(a),es(!0)};return er?(0,a.jsxs)("div",{className:"p-8 text-center text-destructive",children:[(0,a.jsx)("p",{children:"Nepodarilo sa načítať zoznam klientov."}),(0,a.jsx)(i.Button,{variant:"outline",onClick:()=>window.location.reload(),className:"mt-4",children:"Skúsiť znova"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-1 gap-3",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(K.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,a.jsx)(r.Input,{placeholder:"Hľadať klientov...",value:e,onChange:e=>l(e.target.value),className:"pl-9"})]}),(0,a.jsxs)(m.Select,{value:o,onValueChange:d,children:[(0,a.jsx)(m.SelectTrigger,{className:"w-40",children:(0,a.jsx)(m.SelectValue,{placeholder:"Status"})}),(0,a.jsxs)(m.SelectContent,{children:[(0,a.jsx)(m.SelectItem,{value:"all",children:"Všetky statusy"}),Object.entries(W).map(([e,s])=>(0,a.jsx)(m.SelectItem,{value:e,children:s},e))]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"flex border border-border rounded-lg p-1",children:[(0,a.jsx)(i.Button,{variant:"grid"===x?"secondary":"ghost",size:"icon-sm",onClick:()=>j("grid"),children:(0,a.jsx)(H,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{variant:"list"===x?"secondary":"ghost",size:"icon-sm",onClick:()=>j("list"),children:(0,a.jsx)(Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)(i.Button,{onClick:()=>P(!0),children:[(0,a.jsx)(h.Plus,{className:"mr-2 h-4 w-4"})," Pridať klienta"]}),(0,a.jsx)(u,{open:S,onOpenChange:P})]})]}),ei?(0,a.jsx)("div",{className:(0,G.cn)("grid gap-4 mt-6","grid"===x?"md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"),children:[1,2,3,4,5,6].map(e=>(0,a.jsx)(N.Skeleton,{className:"h-[220px]"},e))}):(0,a.jsx)("div",{className:(0,G.cn)("grid gap-4 mt-6","grid"===x?"md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"),children:ed.map(e=>(0,a.jsx)(O.Card,{className:"shadow-soft hover:shadow-md transition-all duration-200 cursor-pointer group",children:(0,a.jsxs)(O.CardContent,{className:"p-5",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(E.Avatar,{className:"h-12 w-12 bg-primary/10",children:(0,a.jsx)(E.AvatarFallback,{className:"bg-primary/10 text-primary font-medium",children:(e.contact_name||"?").split(" ").map(e=>e[0]).join("").substring(0,2)})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-foreground",children:e.contact_name}),e.company_name&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,a.jsx)(q.Building2,{className:"h-3 w-3"}),e.company_name]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.phone&&(0,a.jsx)(i.Button,{variant:"ghost",size:"icon-sm",onClick:a=>ep(e,"call",a),className:"h-7 w-7 text-muted-foreground hover:text-foreground",title:"Zavolať",children:(0,a.jsx)(k.Phone,{className:"h-3.5 w-3.5"})}),e.email&&(0,a.jsx)(i.Button,{variant:"ghost",size:"icon-sm",onClick:a=>ep(e,"email",a),className:"h-7 w-7 text-muted-foreground hover:text-foreground",title:"Poslať email",children:(0,a.jsx)(f.Mail,{className:"h-3.5 w-3.5"})}),(0,a.jsx)(i.Button,{variant:"ghost",size:"icon-sm",onClick:a=>ep(e,"note",a),className:"h-7 w-7 text-muted-foreground hover:text-foreground",title:"Pridať poznámku",children:(0,a.jsx)(F.StickyNote,{className:"h-3.5 w-3.5"})})]}),(0,a.jsxs)(Q.DropdownMenu,{children:[(0,a.jsx)(Q.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(i.Button,{variant:"ghost",size:"icon-sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(J.MoreHorizontal,{className:"h-4 w-4"})})}),(0,a.jsxs)(Q.DropdownMenuContent,{align:"end",children:[(0,a.jsx)(Q.DropdownMenuItem,{onClick:()=>{b(e),D(!0)},children:"Zobraziť detail"}),(0,a.jsx)(Q.DropdownMenuItem,{onClick:()=>{ee(e.id),B(!0)},children:"Vytvoriť ponuku"}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Q.DropdownMenuItem,{onClick:()=>{w(e),M(!0)},children:"Upraviť"}),(0,a.jsx)(Q.DropdownMenuItem,{className:"text-destructive",onClick:()=>ex(e.id),children:"Vymazať"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[e.email&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(f.Mail,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate",children:e.email})]}),e.phone&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(k.Phone,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.phone})]}),e.address&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(_.MapPin,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"truncate",children:e.address})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-border",children:[(0,a.jsx)(v.Badge,{variant:X[e.status],children:W[e.status]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Celková hodnota"}),(0,a.jsx)("p",{className:"font-semibold text-foreground",children:eh(e.total_value)})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3 text-xs text-muted-foreground",children:[(0,a.jsx)("span",{children:em(e.region_id)}),(0,a.jsx)("span",{children:e.assigned_user?.full_name||"—"})]})]})},e.id))}),!ei&&0===ed.length&&(0,a.jsx)(U.EmptyState,{icon:(0,a.jsx)($.Users,{className:"h-full w-full"}),title:e?"Nenašli sa žiadne výsledky":"Ešte nemáte žiadnych klientov",description:e?`Pre v\xfdraz "${e}" sme nenašli žiadnu zhodu.`:"Pridajte svojho prvého klienta alebo konvertujte lead na klienta.",action:{label:"Pridať klienta",onClick:()=>P(!0),icon:(0,a.jsx)(h.Plus,{className:"h-4 w-4"})}}),(0,a.jsx)(T,{client:C,open:z,onOpenChange:D,statusLabels:W,statusVariants:X,getRegionName:em,formatCurrency:eh,onEdit:()=>{D(!1),w(C),M(!0)}}),(0,a.jsx)(g,{client:y,open:I,onOpenChange:M}),(0,a.jsx)(A.CreateQuoteDialog,{open:L,onOpenChange:B,defaultClientId:Y}),(0,a.jsx)(V,{open:ea,onOpenChange:es,entityType:"client",entityId:C?.id||"",entityName:C?.contact_name,defaultType:et,defaultContact:{email:C?.email||void 0,phone:C?.phone||void 0}})]})}e.s(["ClientsClientView",()=>Y],35914)},31091,e=>{e.n(e.i(35914))}]);